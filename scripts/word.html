<!DOCTYPE html>
<html class="writer-html5" lang="en" >
<head>
  <meta charset="utf-8" /><meta name="generator" content="Docutils 0.17.1: http://docutils.sourceforge.net/" />

  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>Interacting with MS Word &mdash; Reproducible Computational Science  documentation</title>
      <link rel="stylesheet" href="../_static/pygments.css" type="text/css" />
      <link rel="stylesheet" href="../_static/css/theme.css" type="text/css" />
  <!--[if lt IE 9]>
    <script src="../_static/js/html5shiv.min.js"></script>
  <![endif]-->
  
        <script data-url_root="../" id="documentation_options" src="../_static/documentation_options.js"></script>
        <script src="../_static/jquery.js"></script>
        <script src="../_static/underscore.js"></script>
        <script src="../_static/_sphinx_javascript_frameworks_compat.js"></script>
        <script src="../_static/doctools.js"></script>
        <script src="../_static/sphinx_highlight.js"></script>
    <script src="../_static/js/theme.js"></script>
    <link rel="index" title="Index" href="../genindex.html" />
    <link rel="search" title="Search" href="../search.html" /> 
</head>

<body class="wy-body-for-nav"> 
  <div class="wy-grid-for-nav">
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search" >
            <a href="../index.html" class="icon icon-home"> Reproducible Computational Science
          </a>
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="../search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>
        </div><div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="Navigation menu">
              <p class="caption" role="heading"><span class="caption-text">Contents:</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../reproducibility.html">What makes scientific results reproducible?</a></li>
<li class="toctree-l1"><a class="reference internal" href="../example.html">A complete, executable example</a></li>
<li class="toctree-l1"><a class="reference internal" href="../CONTRIBUTING.html">Contributing</a></li>
<li class="toctree-l1"><a class="reference internal" href="../docker.html">Docker</a></li>
<li class="toctree-l1"><a class="reference internal" href="../pydoit.html">doit</a></li>
<li class="toctree-l1"><a class="reference internal" href="../snakemake.html">Snakemake</a></li>
<li class="toctree-l1"><a class="reference internal" href="../conda.html">Conda</a></li>
<li class="toctree-l1"><a class="reference internal" href="modify_files.html">Modifying files in python</a></li>
</ul>

        </div>
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap"><nav class="wy-nav-top" aria-label="Mobile navigation menu" >
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="../index.html">Reproducible Computational Science</a>
      </nav>

      <div class="wy-nav-content">
        <div class="rst-content">
          <div role="navigation" aria-label="Page navigation">
  <ul class="wy-breadcrumbs">
      <li><a href="../index.html" class="icon icon-home"></a> &raquo;</li>
      <li>Interacting with MS Word</li>
      <li class="wy-breadcrumbs-aside">
            <a href="../_sources/scripts/word.rst.txt" rel="nofollow"> View page source</a>
      </li>
  </ul>
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
             
  <section id="interacting-with-ms-word">
<h1>Interacting with MS Word<a class="headerlink" href="#interacting-with-ms-word" title="Permalink to this heading">ÔÉÅ</a></h1>
<p>One use case in reproducible science that works great in the context of
LaTeX files is the separation of text and images, where the images are
generated automatically in separate workflows. For MS Word, the challenge
is to update images of a document automatically.</p>
<p>A MS Word document is basically a zip file containing a text layer and a
picture layer. Those pictures are, if unzipped, stored in word/media and can
be accessed via</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">zipfile</span>

<span class="n">z</span> <span class="o">=</span> <span class="n">zipfile</span><span class="o">.</span><span class="n">ZipFile</span><span class="p">(</span><span class="s2">&quot;report.docx&quot;</span><span class="p">)</span>
<span class="n">all_files</span> <span class="o">=</span> <span class="n">z</span><span class="o">.</span><span class="n">namelist</span><span class="p">()</span>
<span class="n">images</span> <span class="o">=</span> <span class="p">[</span><span class="n">f</span> <span class="k">for</span> <span class="n">f</span> <span class="ow">in</span> <span class="n">all_files</span> <span class="k">if</span> <span class="n">f</span><span class="o">.</span><span class="n">startswith</span><span class="p">(</span><span class="s2">&quot;word/media/&quot;</span><span class="p">)]</span>
<span class="nb">print</span><span class="p">(</span><span class="n">images</span><span class="p">)</span>
</pre></div>
</div>
<p>You can now modify the contents (actually creating a new zip file) to replace
one of the images with another one. This is conveniently done by the provided
<code class="docutils literal notranslate"><span class="pre">class</span> <span class="pre">UpdatableZipFile</span></code> (web search: <em>python replace file in zip</em> lead to
<a class="reference external" href="https://stackoverflow.com/a/35435548">https://stackoverflow.com/a/35435548</a> )</p>
<p>You can direcly overwrite the <em>report.docx</em>, but we chose to work on a copy of
it (<em>report_modified.docx</em>) here.</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">updateable_zip_file</span> <span class="kn">import</span> <span class="o">*</span>

<span class="n">shutil</span><span class="o">.</span><span class="n">copy</span><span class="p">(</span><span class="s2">&quot;report.docx&quot;</span><span class="p">,</span> <span class="s2">&quot;report_modified.docx&quot;</span><span class="p">)</span>

<span class="n">new_images</span> <span class="o">=</span> <span class="p">[</span>  <span class="c1"># order matters!</span>
    <span class="s2">&quot;dummy_images/red.png&quot;</span><span class="p">,</span>
    <span class="s2">&quot;dummy_images/blue.png&quot;</span><span class="p">,</span>
    <span class="s2">&quot;dummy_images/gray.png&quot;</span><span class="p">,</span>
    <span class="s2">&quot;dummy_images/green.png&quot;</span><span class="p">,</span>
<span class="p">]</span>

<span class="k">with</span> <span class="n">UpdateableZipFile</span><span class="p">(</span><span class="s2">&quot;report_modified.docx&quot;</span><span class="p">,</span> <span class="s2">&quot;a&quot;</span><span class="p">)</span> <span class="k">as</span> <span class="n">o</span><span class="p">:</span>
    <span class="k">for</span> <span class="n">new</span><span class="p">,</span> <span class="n">old</span> <span class="ow">in</span> <span class="nb">zip</span><span class="p">(</span><span class="n">new_images</span><span class="p">,</span> <span class="n">images</span><span class="p">):</span>
        <span class="n">o</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="n">new</span><span class="p">,</span> <span class="n">old</span><span class="p">)</span>
</pre></div>
</div>
<p>The big inconvenience is that you cannot recover the image names from
the *.docx file, so you have to rely on the ordering.</p>
<p><strong>Comment (TTitscher):</strong> As the MS Excel/Word is not part of my daily work, I
have no experience how the methods above perform in practice. However, I
believe that this topic is important and I suggest forming a working group
(lead by someone else) that investigates the methods further.</p>
</section>


           </div>
          </div>
          <footer>

  <hr/>

  <div role="contentinfo">
    <p>&#169; Copyright 2020, Thomas Titscher, Christoph Pohl.</p>
  </div>

  Built with <a href="https://www.sphinx-doc.org/">Sphinx</a> using a
    <a href="https://github.com/readthedocs/sphinx_rtd_theme">theme</a>
    provided by <a href="https://readthedocs.org">Read the Docs</a>.
   

</footer>
        </div>
      </div>
    </section>
  </div>
  <script>
      jQuery(function () {
          SphinxRtdTheme.Navigation.enable(true);
      });
  </script> 

</body>
</html>